{% if prototype is defined %}
    {% set item = prototype %}
    {% set attr = attr|merge({'data-prototype': block('table_collection_item') }) %}
{% endif %}
{% set attr = attr|merge({'class': 'table table-striped' }) %}
<table {{ block('widget_container_attributes') }}>
    {% if form.parent is empty %}
        <caption>
            {{ form_errors(form) }}
        </caption>
    {% endif %}
    <thead>
      <tr>
        <td id="{{ id ~ '_toolbar' }}" class="btn-toolbar form-actions form-actions-condensed" colspan="4">
            {% include "AvocodeFormExtensionsBundle:Form/BootstrapCollection:collection_add.html.twig" %}
            {% include "AvocodeFormExtensionsBundle:Form/BootstrapCollection:collection_batch_delete.html.twig" %}
        </td>
      </tr>
    </thead>
    <tbody class="collection">
        {% for item in form %}
            {{ block('table_collection_item') }}
        {% endfor %}
    </tbody>
</table>

{% block table_collection_item %}
<tr class="collection-item">
{% if item.vars.compound %}
    <td class="collection-item-compound">
        <div class="accordion" id="{{ 'accordion_' ~ item.vars.id }}">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="{{ '#accordion_' ~ item.vars.id }}" href="{{ '#accordion_body_' ~ item.vars.id }}">
                        <i class="icon-chevron-down"></i>
                        <i class="icon-chevron-right"></i>
                        {{ form_label(item) }}
                    </a>
                    {% include "AvocodeFormExtensionsBundle:Form/BootstrapCollection:collection_delete.html.twig" %}
                </div>
                <div id="{{ 'accordion_body_' ~ item.vars.id }}" class="accordion-body collapse in">
                    <div class="accordion-inner">
                    {{ form_errors(item) }}
                    {{ form_widget(item, { 'attr': {'class': 'form-horizontal'} }) }}
                    </div>
                </div>
            </div>
        </div>
    </td>
{% else %}
    <td class="collection-item-simple">
        <div class="form-horizontal">
            {% include "AvocodeFormExtensionsBundle:Form/BootstrapCollection:collection_delete.html.twig" %}
            <div class="control-group">
                {{ form_label(item) }}
                <div class="controls">
                    {{ form_widget(item) }}
                </div>
                <span class="help-inline">
                    {{ form_errors(item) }}
                </span>
            </div>
        </div>
    </td>
{% endif %}
</tr>
{% endblock table_collection_item %}